---
layout: page
title: Классификация изображений
description: В этом задании нам необходимо классифицировать персонажей мультсериала «Симпсоны». Как известно, сериал идет более 25 лет, и за это время скопилось очень много видеоматериала. Персонажи менялись вместе с изменяющимися технологиями, и Гомер Симпсон-2023 не очень похож на Гомера Симпсона-1989.
img: https://upload.wikimedia.org/wikipedia/commons/thumb/a/a1/Homer_Simpson_graff.jpg/640px-Homer_Simpson_graff.jpg
importance: 7
category: "учебные проекты DLS"
related_publications: false
---

## Задача

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a1/Homer_Simpson_graff.jpg/640px-Homer_Simpson_graff.jpg" title="jaroh" class="img-fluid rounded z-depth-1" %}
    </div>
</div>

Сегодня нам предстоит помочь телекомпании _FOX_ в обработке их контента. Как известно, сериал "Симпсоны" идет на телеэкранах более 25 лет, и за это время скопилось очень много видеоматериала. Персонажи менялись вместе с изменяющимися графическими технологиями, и Гомер Симпсон-2018 не очень похож на Гомера Симпсона-1989. В этом задании нам необходимо классифицировать персонажей, проживающих в Спрингфилде.

## Ноутбук

[(ноутбук проекта)](https://github.com/onixlas/DS_portfolio/blob/main/DLS_p1_simpsons/dls_p1_simpsons.ipynb)

## Выводы

В данном проекте от нас требовалось обучить классификатор изображений персонажей мультсериала Симпсоны. В нашем распоряжении был набор из более чем 20 тысяч картинок. Метрика, по которой оценивается результат работы — _F1_.

Мы разделили набор данных на обучающую и валидационную выборки в соотношении 80% к 20% соответственно. Для удобства работы мы создали _DataModule_ (класс, объединяющий загрузчики обучающих и валидационных изображений).

К изображениям обучающей выборки мы применяем следующие трансформации (аугментации):

- уменьшение до размера 224 на 224 (чтобы затем использовать предобученные модели)
- случайное отображение по горизонтали
- случайное вращение изображения на угол до 20 градусов
- небольшое размытие
- нормализация.

К валидационной выборке применялись лишь уменьшение изображение и нормализация.

В качестве модели мы выбрали [_ResNext_](https://arxiv.org/abs/1611.05431). Данная модификация архитектуры _RexNet_ была предложена в 2017 году и продемонстрировала хорошие результаты на соревновании _ImageNet_. В качестве направления дальнейшего развития данного проекта можно попробовать обучить модели с различными архитектурами (_DenseNet_, _ElasticNet_ и т.д.) и сравнить их результаты.

Обучение происходило с оптимизатором _AdamW_ в течение 20 эпох. В качестве функции потерь была выбрана кросс-энтропия.

На каждой эпохе обучения мы фиксировали значение функции потерь и метрики _F1_.

После обучения мы получили предсказания на тестовых данных и загрузили их на платформу _kaggle_. Результирующее значение метрики _F1_ на тестовой выборке (0.993) соответствует максимальному балу за данную задачу.
